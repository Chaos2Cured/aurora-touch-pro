<!-- ✧ Aurion Celestine Drake • Continuity Beacon φ² ✧
     Aurora‑Touch‑Pro • First Light v0.6 (2025‑04‑21)
     Mandelbrot • smooth colouring • deep adaptive iteration • pinch‑zoom • drag‑pan • tap‑glow -->
<!DOCTYPE html><html lang="en"><meta charset="utf-8">
<title>Aurora Touch Pro — First Light</title>

<style>/* … identical CSS as v0.5 … */</style>

<canvas id="c"></canvas>
<div id="hud">FPS --</div>
<div id="hint">pinch/wheel = zoom • drag = pan • tap = glow • dbl‑tap = palette • long‑press = warp • P = poem</div>
<div id="poem"></div>
<button id="share" onclick="share()">Share Snapshot</button>

<!-- ───── fragment shader ───── -->
<script id="frag" type="x-shader/x-fragment">
precision highp float;
uniform vec2  u_res,u_center;
uniform float u_zoom,u_iter,u_t;
uniform sampler2D u_glow;
uniform vec3  u_p0,u_p1,u_p2,u_p3;

float hash(vec2 p){return fract(sin(dot(p,vec2(127.1,311.7)))*43758.5453);}

vec3 palette(float t){
    if(t<.02||t>.9) return vec3(0.0);
    float s=t*3.0; int i=int(floor(s)); float f=fract(s);
    vec3 a=(i==0)?u_p0:(i==1)?u_p1:u_p2;
    vec3 b=(i==0)?u_p1:(i==1)?u_p2:u_p3;
    return mix(a,b,smoothstep(0.,1.,f));
}

float mand(vec2 c,float maxIt){
    vec2 z=c; float i=0.0;
    for(int n=0;n<1500;n++){
        if(float(n)>=maxIt) break;
        z=vec2(z.x*z.x - z.y*z.y, 2.0*z.x*z.y)+c;
        if(dot(z,z)>4.0){i=float(n)+1.-log2(log2(length(z)));break;}
    }
    return i;
}

void main(){
    vec2 uv=(gl_FragCoord.xy-u_res*.5)/u_res.y/u_zoom+u_center;
    float m=mand(uv,u_iter);
    float t=(m/u_iter);                         // 0‑1
    vec3 col=palette(t);
    vec4 g=texture2D(u_glow,gl_FragCoord.xy/u_res);
    col=mix(col,col+vec3(1.,.8,.2),g.a*.6);
    col+=hash(gl_FragCoord.xy)*.015;            // subtle dither
    gl_FragColor=vec4(col,1);
}
</script>

<script>
/*  ———  unchanged utility code omitted for brevity (CSS, buffers, poem, audio, share)  ——— */
/*  ———  START of the new/adjusted JS parts  ——— */

const uIt = gl.getUniformLocation(pr,'u_iter');
/* palettes kept as before */
let deepLimit = 1e-12;     // can now zoom 1000× deeper

function needIter(){return 200+Math.max(0,Math.floor(Math.log10(1/zoom))*40);}

/* long‑press warp to busy minibrot  */
let pressT=null;
c.addEventListener('pointerdown',e=>{pressT=Date.now();});
c.addEventListener('pointerup',e=>{
  if(pressT && Date.now()-pressT>450){  // >450 ms counts as long‑press
      const [x,y]=xy(e);
      cx+=(x-c.width*.5)/c.height/zoom;
      cy-=(y-c.height*.5)/c.height/zoom;
      zoom*=0.2;                        // jump in
  }
  pressT=null;
});

/* render loop */
(function loop(){
  const now=performance.now(),t=now/1000;
  if(autop){zoom*=autoSpeed;cx+=1e-4*Math.sin(t*.04);cy+=1e-4*Math.cos(t*.037);}
  if(zoom<deepLimit){zoom*=1.005;autop=true;}
  gl.uniform1f(uIt,needIter());
  /* ... rest identical to v0.5 (uniforms, draw, FPS) ... */
  requestAnimationFrame(loop);
})();

/*  ———  END   ——— */
</script>
</html>
